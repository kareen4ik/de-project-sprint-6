Привет, ревьювер! Меня зовут Карина, у меня опыт в продуктовой аналитике 4 года, недавно приступила к работе дата инженером в британском стартапе. Буду рада комментариям, как стать профи в этой профессии.

По нашему проекту: он несложный, но не без нюансов.

<h2>1. Загрузка данных из S3</h2>
Заливаем данные из S3 в папку /data/ Написала DAG для Airflow, который с помощью библиотеки boto3 скачивает данные. Назвала этот DAG download_group_log.py.
В процессе пободалась с ошибками, о которых уведомлял VSCode в процессе тестирования скрипта: говорит, не используй в даге `schedule_interval`, он вот-вот станет deprecated, используй `schedule`. Оке, я не против идти в ногу с быстро меняющимися технологиями, вот только в проекте у нас развёрнут не совсем новый Airflow, который падал с ошибкой: он ещё не знает, что такое schedule.

Следующий DAG — `load_stg_group_log.py` — загрузил данные из папки /data/ в таблицу group_log в слое STAGING. Столкнулась с ошибкой:
python```PermissionDenied: Severity: ERROR, Message: Permission denied for storage location```

По ходу, Vertica не имела прав на доступ к папке. Пришлось немного побороться, в итоге команда COPY отработала, т.е. импортировала данные из CSV в таблицу group_log.

<h2> Раскладывание данных по таблицам схемы DWH</h2>
В DWH добавила новые таблицы (DDL – в папке DDL проекта)

`l_user_group_activity`: связь пользователей с группами.
`s_auth_history`: история действий пользователей.


INSERT'ом раскладываем данные по табличкам.

<h2>СТЕ для анализа данных</h2>
Для анализа активности пользователей в группах написала два CTE:

user_group_log: подсчитывает количество пользователей, которые вступили в группу (cnt_added_users).

Источник: таблица s_auth_history, учитываются только события event = 'add'.
Агрегирование – по идентификатору группы (hk_group_id).

user_group_messages: подсчитывает количество пользователей, которые написали хотя бы одно сообщение в группе (cnt_users_in_group_with_messages). Для факта отправки сообщения использую уже существующую таблицу l_user_message.
Связь с группами через l_user_group_activity.
Агрегирование – по hk_group_id.

<h2>Анализ данных и расчёт конверсий</h2>
Финальный скрипт соединяет данные о вступлениях и сообщениях для каждой группы.

Результаты, если я всё сделала правильно, впечатляющие. Средняя конверсия составляет ~97.3% – а это очень высокий уровень вовлечённости пользователей. 

Дополнительно, я бы предложила бизнесу отсмотреть динамику, чтобы понять, как быстро юзеры начинают строчить сообщения после вступления. Также подсчитать среднее кол-во сообщений на юзера.